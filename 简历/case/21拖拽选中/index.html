<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			body{
				overflow: hidden;
				perspective: 1000px;
			}
			.box{
				border: 1px solid black;
				position: absolute;
			}
			.item{
				width: 100px;
				height: 100px;
				background: #ccc;
				position: absolute;
				border-radius:15px ;
				font: 36px/100px arial;
				text-align: center;
				z-index: 0;
				opacity: 0.9;
				transition:1s ;            /* left\top都设置*/
			}
		</style>
	</head>
	<body id="body">
		<div class="item">A</div>
		<div class="item">B</div>
		<div class="item">C</div>
		<div class="item">D</div>
		<div class="item">E</div>
		<div class="item">F</div>
		<div class="item">G</div>
		<div class="item">H</div>
		<div class="item">I</div>
		<div class="item">J</div>
		<div class="item">K</div>
		<div class="item">L</div>
		<script type="text/javascript">
			var zIndex=0;       //按用户点击顺序排列层级，最后点的一定在最上面
			var items=document.getElementsByClassName("item");
			//初始位置
			items[0].style.left=-300+"px";
			items[0].style.top=-300+"px";
			items[4].style.left=-300+"px";
			items[8].style.left=-300+"px";
			items[8].style.top=1300+"px";
			items[1].style.left=-100+"px";
			items[1].style.top=-300+"px";
			items[5].style.left=-100+"px";
			items[9].style.left=-100+"px";
			items[9].style.top=1300+"px";
			items[2].style.left=2000+"px";
			items[2].style.top=-300+"px";
			items[6].style.left=2000+"px";
			items[10].style.left=2000+"px";
			items[10].style.top=1300+"px";
			items[3].style.left=2300+"px";
			items[3].style.top=-300+"px";
			items[7].style.left=2300+"px";
			items[11].style.left=2300+"px";
			items[11].style.top=1300+"px";
			//初始化item
			setTimeout(function(){
				for (var i = 0; i < items.length; i++) {
					items[i].style.left=window.innerWidth/2-275+i%4*150+"px";
					items[i].style.top=300+Math.floor(i/4)*150+"px";
					items[i].onOff=false;    //对应没被框选
					items[i].onmousedown=function(e){
						var _this=this;
						if(_this.onOff==false){        //如果是没选中的。判断是点在选中的还是没选中的
							for (var i = 0; i < items.length; i++) {
								items[i].style.background="#ccc";
								items[i].style.color="#000";
								items[i].onOff=false;
							}
							_this.style.background="orange";
							_this.style.color="#fff";
							_this.onOff=true;
							zIndex++;
							_this.style.zIndex=zIndex;
						}
						e.cancelBubble=true;
						var disX=e.clientX-_this.offsetLeft;
						var disY=e.clientY-_this.offsetTop;
						document.onmousemove=function(e){
							for (var i = 0; i < items.length; i++) {      //问题，只能拖动它前面的div
								if(items[i].onOff){
									console.log(i);
									items[i].style.left=e.clientX+(items[i].offsetLeft-_this.offsetLeft)-disX+"px";
									items[i].style.top=e.clientY+(items[i].offsetTop-_this.offsetTop)-disY+"px";
								}
							}
						}
						_this.onmouseup=function(){
							document.onmousemove=null;
						}
						return false;
					}
				}
				setTimeout(function(){
					for (var i = 0; i < items.length; i++) {
						items[i].style.transition=0+'s';
					}
				},1000)
			},500)
			//框选元素
			var lastX;
			var lastY;
			var div;
			document.onmousedown=function (e) {
				lastX=e.clientX;
				lastY=e.clientY;
				for (var i = 0; i < items.length; i++) {  //点击空白清空颜色
					items[i].style.background="#ccc";
					items[i].style.color="#000";
					items[i].onOff=false;
				}
				div=document.createElement("div");
				div.className="box";
				document.body.appendChild(div);
				document.onmousemove=function(e){
					div.style.width=Math.abs(e.clientX-lastX)+"px";
					div.style.height=Math.abs(e.clientY-lastY)+"px";
					if(e.clientX>lastX){    //向右拖
						div.style.left=lastX+"px";
						div.style.right="auto";
					}else{                    //向左拖
						div.style.right=window.innerWidth-lastX+"px";
						div.style.left="auto";
					}
					if(e.clientY>lastY){      //向下拖
						div.style.top=lastY+"px";
						div.style.bottom="auto";
					}else{                   //向上拖
						div.style.bottom=window.innerHeight-lastY+"px";
						div.style.top="auto";
					}
					//碰撞检测
					var divL=div.getBoundingClientRect().left;  //div左边界
					var divR=div.getBoundingClientRect().right; //div右边界
					var divT=div.getBoundingClientRect().top;   //div上边界
					var divB=div.getBoundingClientRect().bottom; //div下边界
					for (var i = 0; i < items.length; i++) {
						if(divR>items[i].offsetLeft&&divB>items[i].offsetTop&&divL<items[i].getBoundingClientRect().right&&divT<items[i].getBoundingClientRect().bottom){   
							items[i].style.background="orange";
							items[i].style.color="#fff";
							items[i].onOff=true;
							zIndex++;
							items[i].style.zIndex=zIndex;
						}else{
							items[i].style.background="#ccc";
							items[i].style.color="#000";
							items[i].onOff=false;
						}
					}
				}
				document.onmouseup=function(){
					document.onmousemove=null;
					if(document.body.getElementsByClassName("box")[0]){
						document.body.removeChild(div);
					}
				}
				return false;      //阻止浏览器默认行为
			}
		</script>
	</body>
</html>

 实现了：
 	①判断拖拽一群还是单个，不同的切换效果  47行
 	②只能单选一个、只能群选一群
 	③未能实现按住ctrl
 	④实现了用户后点击的在最上面。
 
 
